package third_party.lib.opencv

@Build(script="$(EXTERNAL_MAKE)")
@BuildArtifactPath(cppflags="-I$(EXTERNAL_BUILD_DIR)/third_party/lib/opencv/build/install/include/opencv4")
@BuildDepends(third_party.gcc.libstdcxx)
@BuildDepends(third_party.gcc.libsupcxx)
static module build {
	option string opencv_version="4.0.1"

	/* Disables fonts for OpenCV version 4.5.2. It's used
	 * to minimize .rodata size by ~70 Kb. */
	option boolean hack_4_5_2_disable_fonts=true

	depends embox.compat.posix.proc.atexit_api
	depends embox.compat.posix.util.gettimeofday
	depends embox.compat.atomic.pseudo_atomic
	depends embox.compat.libc.math
	@NoRuntime depends embox.compat.posix.sys.mman.mmap_api // include sys/mman.h
	@NoRuntime depends embox.compat.libc.all
	@NoRuntime depends embox.compat.posix.pthread_key
	@NoRuntime depends third_party.gcc.libstdcxx
	@NoRuntime depends third_party.gcc.libsupcxx
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_core {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_core.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_imgcodecs {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_imgcodecs.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_imgproc {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_imgproc.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_objdetect {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_objdetect.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_videoio {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_videoio.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_calib3d {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_calib3d.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_flann {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_flann.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libopencv_features2d {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/libopencv_features2d.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module liblibpng {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/opencv4/3rdparty/liblibpng.a"

	@NoRuntime depends build
}

@LinkerSection(text="cv_text",rodata="cv_rodata",data="cv_data",bss="cv_bss",arm_exidx="cv_arm_exidx",arm_extab="cv_arm_extab")
@BuildDepends(third_party.lib.opencv.build)
@Build(script="true")
static module libzlib {
	source "^BUILD/extbld/third_party/lib/opencv/build/install/lib/opencv4/3rdparty/libzlib.a"

	@NoRuntime depends build
}

@BuildDepends(third_party.lib.opencv.build)
static module all {
	@NoRuntime depends libopencv_core
	@NoRuntime depends libopencv_imgcodecs
	@NoRuntime depends libopencv_imgproc
	@NoRuntime depends libopencv_objdetect
	@NoRuntime depends libopencv_videoio
	@NoRuntime depends libopencv_calib3d
	@NoRuntime depends libopencv_flann
	@NoRuntime depends libopencv_features2d
	@NoRuntime depends liblibpng
	@NoRuntime depends libzlib
}
